<ion-header>
  <ion-toolbar>
    <ion-title>Settings</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="centeredContent">
    <ion-card>
      <ion-card-header>
        <ion-card-title>Connected Databases</ion-card-title>
        <ion-card-subtitle></ion-card-subtitle>
      </ion-card-header>
      <ion-card-content>
        <ion-note class="hint"
                  color="medium">
          <p>All connection strings are stored securely using encryption.</p>
        </ion-note>
        @if (tenantService.loading()) {
        <div class="loadingContainer">
          <ion-spinner></ion-spinner>
          <p>Loading connected databases...</p>
        </div>
        } @else if (tenantService.error()) {
        <ion-note color="danger">
          Error: {{ tenantService.error() }}
        </ion-note>
        } @else {
        <ion-list>
          @if (tenantService.tenants().length === 0) {
          <ion-item>
            <ion-label>
              <p>No tenants configured. Create one to get started.</p>
            </ion-label>
          </ion-item>
          } @else {
          @for (tenant of tenantService.tenants(); track tenant.id) {
          <ion-item class="tenantItem">
            <div class="tenantContent">
              <ion-label>
                <h3>{{ tenant.dbName }}</h3>
                <p>{{ tenant.hostname }}</p>
              </ion-label>
              <div class="tenantActions">
                <ion-button [fill]="tenantService.selectedTenantId() === tenant.id ? 'solid' : 'outline'"
                            [disabled]="tenantService.selectedTenantId() === tenant.id"
                            (click)="onTenantChange(tenant.id)">
                  {{ tenantService.selectedTenantId() === tenant.id ? 'Active' : 'Connect' }}
                </ion-button>
                <ion-button color="danger"
                            fill="clear"
                            [disabled]="!tenant.userId"
                            (click)="disconnectTenant(tenant.id)">
                  Disconnect
                </ion-button>
              </div>
            </div>
          </ion-item>
          }
          }

          <ion-item>
            <ion-button expand="block"
                        (click)="createTenant()">
              Connect to a new database
            </ion-button>
          </ion-item>
        </ion-list>
        }
      </ion-card-content>
    </ion-card>

    <!-- <ion-card>
      <ion-card-header>
        <ion-card-title>Application Info</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item>
            <ion-label>
              <h2>Version</h2>
              <p>1.0.0</p>
            </ion-label>
          </ion-item>
          @if (tenantService.selectedTenant()) {
          <ion-item>
            <ion-label>
              <h2>Current Database</h2>
              <p>{{ tenantService.selectedTenant()?.dbName }}</p>
            </ion-label>
          </ion-item>
          }
        </ion-list>
      </ion-card-content>
    </ion-card> -->
  </div>
</ion-content>